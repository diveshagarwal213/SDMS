<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search And Read</title>
    <script src="jquery.js"></script>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/searchTopics.css">
</head>
<body>
    <div>
        <input type="text" id="searchBox">
        
    </div>
    <div id="loadDiv">
        
    </div>
    <div id="titleBody"></div>

    <script>

        $(document).ready( function(){

            //key up
            $("#searchBox").keyup(function () {
                if(this.value.length >= 3){
                    var search1 = $("#searchBox").val();
                    $("#loadDiv").html(""); 
                    //console.log(search1);   
                    $.ajax({
                        url: "http://localhost/sdms/php_files/databaseApi.php?api_id=7&search=" + search1,
                        type: "GET",
                        success: function(data){
                            if(data[0].status == false){
                                $("#loadDiv").append("<tr><td><h2>" + data[0].message + "</h2></td></tr>"); 
                            }else{
                                $.each(data, function(key, value){
                                    $("#loadDiv").append("<button class='same' data-id='" + value.tid + "'>" + value.title + "</button>");
                                });
                            }
                        }
                    });
                }
            })

            //load tbody
            $(document).on("click",".same", function(){
                var idarr = $(this).data("id");
                var idobj = {id: idarr};
                var idjson = JSON.stringify(idobj);
                //console.log(idjson);
                $.ajax({
                    url:"http://localhost/sdms/php_files/databaseApi.php?api_id=3",
                    type:"POST",
                    data: idjson,
                    success: function(data){
                        if(data.status == false){
                            alert(data.message);
                        }else{
                            var tbody2 = data[0].tbody;
                            $("#titleBody").html(tbody2);
                        }
                    }
                });
            });
            
            //active button color
            $(document).on("click",".same", function(){
                $("#loadDiv button:nth-child(even)").css({"background-color": "#f2f2f2"});
                $("#loadDiv button:nth-child(odd)").css({"background-color": "#414141"});
                $(this).css({"background-color": "#E09A3A"});
            });

        });//ready
        
    </script>
</body>
</html>